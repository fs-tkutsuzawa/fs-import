# 会計実務家向け解説：テストシナリオで見る財務モデリングエンジンの挙動

**日付**: 2025年10月8日
**目的**: エンジニアが実装したテストシナリオが、会計実務上のどのような取引を想定し、財務三表（PL, BS, CF）にどう影響するかを、非エンジニア（特に会計実務家）にも理解可能な形で解説する。

---

## はじめに

このドキュメントは、私たちの財務モデリングエンジンが「会計的に正しい」ことを保証するために実施した、一連のテストシナリオの「会計的な意味」を翻訳したものです。各テストは、以下のような日常的な企業の経済活動をシミュレートしています。

## Part 1: 財務活動（CFF）- 会社のお金集めと株主還元

ここでは、会社の資金繰りの根幹である財務活動をテストしました。

#### テストシナリオ [CFF-01]: 銀行からの長期借入

- **取引の想定**: 銀行から新たに2,000万円を長期で借り入れた。
- **仕訳イメージ**: `（借）現金 2,000 / （貸）長期借入金 2,000`
- **財務三表への影響**:
  - **BS**: `資産`の部の`現金`が2,000増加し、`負債`の部の`長期借入金`も2,000増加する。貸借は一致。
  - **CF**: 「財務活動によるキャッシュフロー(CFF)」が`+2,000`（資金調達による現金の純増）として記録される。
- **テストの狙い**: この基本的な資金調達取引が、BSとCFに正しく反映されるかを確認しました。

#### テストシナリオ [CFF-02]: 借入金の元本返済

- **取引の想定**: 銀行への借入金のうち、元本500万円を現金で返済した。
- **仕訳イメージ**: `（借）長期借入金 500 / （貸）現金 500`
- **財務三表への影響**:
  - **BS**: `資産`の部の`現金`が500減少し、`負債`の部の`長期借入金`も500減少する。
  - **CF**: 「財務活動によるキャッシュフロー(CFF)」が`-500`（返済による現金の純減）として記録される。
- **テストの狙い**: 資金の返済という、調達とは逆の取引を正しく処理できるかを確認しました。

#### テストシナリオ [CFF-04]: 株主への配当金支払い

- **取引の想定**: 株主への還元として、利益剰余金から300万円の配当を現金で支払った。
- **仕訳イメージ**: `（借）利益剰余金 300 / （貸）現金 300`
- **財務三表への影響**:
  - **BS**: `資産`の部の`現金`が300減少し、`純資産`の部の`利益剰余金`も300減少する。
  - **CF**: 「財務活動によるキャッシュフロー(CFF)」が`-300`（配当による現金の純減）として記録される。
- **テストの狙い**: 利益の分配という、株主との取引がBSとCFに正しく反映されるかを確認しました。

## Part 2: 投資活動（CFI）- 事業を成長させるための投資

ここでは、将来の利益を生み出すための投資活動をテストしました。

#### テストシナリオ [CFI-02]: 古い機械の売却（売却益が出たケース）

- **取引の想定**: 帳簿価額800万円の機械を、1,000万円で売却し、代金は現金で受け取った。差額の200万円は「固定資産売却益」となる。
- **仕訳イメージ**:
  - `（借）現金 1,000`
  - `（貸）有形固定資産 800`
  - `（貸）固定資産売却益 200`
- **財務三表への影響**:
  - **PL**: `特別利益`に`固定資産売却益`が200計上され、その分だけ利益が増加する。
  - **BS**: `資産`の部の`有形固定資産`が800減少し、`現金`が1,000増加する。差し引きで資産全体は200増加。この増加分は、PLの利益が`利益剰余金`に振り替えられることで、貸借が一致する。
  - **CF**: ここが最も複雑です。
    - **CFO（営業CF）**: PLの利益には、本業の儲けではない「固定資産売却益」200が含まれています。これは現金収入を伴わない（ように見える）利益なので、CFOの計算上、利益からマイナス調整します。
    - **CFI（投資CF）**: 実際に得た現金の全額である`+1,000`が、「投資活動によるキャッシュフロー」として記録されます。
- **テストの狙い**: このエンジンが、PL上の利益と実際の現金の動きの違いを正しく理解し、CFOとCFIに適切に再分類できるか、という高度な会計ロジックを検証しました。

## Part 3: 営業活動（CFO）- 日々の商売の成果

ここでは、本業の儲けである営業活動の精度を検証しました。

#### テストシナリオ [CFO-02]: 減損損失の計上

- **取引の想定**: 工場の機械の収益性が著しく低下したため、200万円の「減損損失」を計上し、その分だけ機械の帳簿価額を切り下げた。
- **仕訳イメージ**: `（借）減損損失 200 / （貸）有形固定資産 200`
- **財務三表への影響**:
  - **PL**: `特別損失`に`減損損失`が200計上され、その分だけ利益が減少する。
  - **BS**: `資産`の部の`有形固定資産`が200減少する。PLの損失が`利益剰余金`を減少させるため、貸借は一致する。
  - **CF**: PLで費用として計上されていますが、**実際には現金は1円も出ていっていません**。このような「非資金性費用」は、CFOの計算上、利益にプラスして（足し戻して）調整します。
- **テストの狙い**: 「損失だけど、現金は減っていない」という会計の重要な概念を、エンジンが正しく理解しているかを確認しました。

#### テストシナリオ [CFO-03]: 未払法人税の処理

- **取引の想定**: 当期の税金費用（PL）は200万円だったが、期末時点でまだ支払っていない「未払法人税」（BS）が30万円増えた。
- **会計的意味**: これは、実際に現金で支払った税金が`200 - 30 = 170`万円だったことを意味します。
- **財務三表への影響**:
  - **CF**: CFOの計算では、PLの利益（税引後）からスタートし、この「未払法人税」の増加額30万円をプラス調整します。これにより、現金支払ベースの税金費用が間接的に計算され、より正確な営業キャッシュフローが算出されます。
- **テストの狙い**: PL上の費用と、実際の現金支出のタイミングのズレ（＝運転資本の増減）を、エンジンが正しくCFOに反映できるかを確認しました。

## まとめ

今回拡充したテスト群は、単なる計算チェックではありません。上記のように、一つ一つが具体的な会計取引をシミュレートし、それが三表にまたがって有機的に、そして会計原則に忠実に反映されることを検証するものです。これらのテストをパスし続けることで、本エンジンは複雑なビジネスシナリオにおいても信頼に足る財務モデルを構築できる、という自信を我々に与えてくれます。
